CREATE TABLE usuarios (
    documento varchar(25) NOT NULL,
    nombre_usuario varchar(50) NOT NULL,
    contrasena varchar(25) NOT NULL,
    correo varchar(50) NOT NULL,
    nombres_apellidos varchar(100) NOT NULL,
    area varchar(25) NOT NULL,
    cargo varchar(25) NOT NULL,
    estado varchar(50) NOT NULL,
    PRIMARY KEY (documento)
);

CREATE TABLE administradores (
    documento varchar(25) NOT NULL,
    nombre_usuario varchar(50) NOT NULL,
    contrasena varchar(25) NOT NULL,
    correo varchar(50) NOT NULL,
    nombres_apellidos varchar(100) NOT NULL,
    area varchar(25) NOT NULL,
    cargo varchar(25) NOT NULL,
    rol varchar(255) DEFAULT NULL,
    PRIMARY KEY (documento),
    FOREIGN KEY (documento) REFERENCES usuarios(documento)
);

CREATE TABLE cargos (
    id int(11) NOT NULL AUTO_INCREMENT,
    nombre_cargo varchar(255) NOT NULL,
    PRIMARY KEY (id),
    UNIQUE (nombre_cargo)
);

CREATE TABLE roles (
    id int(11) NOT NULL AUTO_INCREMENT,
    nombre_rol varchar(255) NOT NULL,
    PRIMARY KEY (id),
    UNIQUE (nombre_rol)
);

CREATE TABLE documentos (
    id int(11) NOT NULL AUTO_INCREMENT,
    codigo varchar(50) NOT NULL,
    tipo_documento enum('Word', 'Excel', 'PDF', 'PowerPoint', 'Texto', 'Otro') NOT NULL,
    estado enum('Activo', 'Inactivo', 'Pendiente', 'Archivado') NOT NULL,
    fecha_creacion timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
    fecha_modificacion timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    PRIMARY KEY (id)
);

CREATE TABLE listado_maestro (
    id int(11) NOT NULL AUTO_INCREMENT,
    proceso varchar(255) DEFAULT NULL,
    codigo varchar(50) DEFAULT NULL,
    titulo_documento varchar(255) DEFAULT NULL,
    tipo varchar(255) DEFAULT NULL,
    version varchar(50) DEFAULT NULL,
    estado varchar(100) DEFAULT NULL,
    fecha_aprobacion date DEFAULT NULL,
    areas text DEFAULT NULL,
    motivo_del_cambio text DEFAULT NULL,
    tiempo_de_retencion varchar(100) DEFAULT NULL,
    responsable_de_retencion varchar(100) DEFAULT NULL,
    lugar_de_almacenamiento_fisico varchar(100) DEFAULT NULL,
    lugar_de_almacenamiento_magnetico text DEFAULT NULL,
    conservacion varchar(100) DEFAULT NULL,
    disposicion_final varchar(100) DEFAULT NULL,
    copias_controladas varchar(100) DEFAULT NULL,
    fecha_de_vigencia date DEFAULT NULL,
    dias int(11) DEFAULT NULL,
    senal_alerta varchar(50) DEFAULT NULL,
    obsoleto tinyint(1) DEFAULT NULL,
    anulado tinyint(1) DEFAULT NULL,
    en_actualizacion tinyint(1) DEFAULT NULL,
    PRIMARY KEY (id)
);

CREATE TABLE log_eventos (
    id_usuario int(11) NOT NULL,
    evento varchar(255) NOT NULL,
    fecha datetime NOT NULL,
    PRIMARY KEY (id_usuario, fecha),
    FOREIGN KEY (id_usuario) REFERENCES usuarios(documento)
);

CREATE TABLE password_resets (
    id int(11) NOT NULL AUTO_INCREMENT,
    email varchar(255) NOT NULL,
    token varchar(100) NOT NULL,
    created_at timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
    PRIMARY KEY (id),
    FOREIGN KEY (email) REFERENCES usuarios(correo)
);

CREATE TABLE procesos (
    id int(11) NOT NULL AUTO_INCREMENT,
    macroproceso varchar(255) NOT NULL,
    proceso varchar(255) NOT NULL,
    usuarios varchar(255) NOT NULL,
    cargos varchar(255) NOT NULL,
    rol varchar(50) NOT NULL,
    email varchar(255) NOT NULL,
    PRIMARY KEY (id),
    FOREIGN KEY (rol) REFERENCES roles(nombre_rol),
    FOREIGN KEY (cargos) REFERENCES cargos(nombre_cargo),
    FOREIGN KEY (email) REFERENCES usuarios(correo)
);
